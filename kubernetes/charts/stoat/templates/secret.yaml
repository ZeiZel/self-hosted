apiVersion: v1
kind: Secret
metadata:
  name: revolt-secrets
  namespace: {{ .Release.Namespace }}
type: Opaque
stringData:
  # MongoDB
  MONGO_URL: "mongodb://{{ .Values.mongodb.username }}:{{ .Values.mongodb.password }}@{{ .Values.mongodb.host }}:{{ .Values.mongodb.port }}/{{ .Values.mongodb.database }}?authSource={{ .Values.mongodb.authSource }}"

  # Redis
  REDIS_URL: "redis://{{ if .Values.redis.password }}:{{ .Values.redis.password }}@{{ end }}{{ .Values.redis.host }}:{{ .Values.redis.port }}/0"

  # S3
  S3_ENDPOINT: "{{ .Values.s3.endpoint }}"
  S3_REGION: "{{ .Values.s3.region }}"
  S3_ACCESS_KEY: "{{ .Values.s3.accessKey }}"
  S3_SECRET_KEY: "{{ .Values.s3.secretKey }}"
  S3_BUCKET: "{{ .Values.s3.bucket }}"

  # URLs
  API_URL: "{{ .Values.revolt.config.apiUrl }}"
  APP_URL: "{{ .Values.revolt.config.appUrl }}"
  PUBLIC_URL: "{{ .Values.revolt.config.publicUrl }}"

  # SAML2
  {{- if .Values.saml.enabled }}
  SAML_ENABLED: "true"
  SAML_ENTRY_POINT: "{{ .Values.saml.entrypoint }}"
  SAML_ISSUER: "{{ .Values.saml.issuer }}"
  SAML_IDENTIFIER_FORMAT: "{{ .Values.saml.identifierFormat }}"
  SAML_NAME_ID_FORMAT: "{{ .Values.saml.nameIDFormat }}"
  {{- if .Values.saml.cert }}
  SAML_CERT: "{{ .Values.saml.cert }}"
  {{- end }}
  {{- end }}

  {{- if .Values.smtp.enabled }}
  SMTP_HOST: "{{ .Values.smtp.host }}"
  SMTP_PORT: "{{ .Values.smtp.port }}"
  SMTP_FROM: "{{ .Values.smtp.from }}"
  SMTP_USERNAME: "{{ .Values.smtp.username }}"
  SMTP_PASSWORD: "{{ .Values.smtp.password }}"
  {{- end }}
