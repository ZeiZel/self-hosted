namespace: consul

# Consul Server
server:
  enabled: true
  replicas: 3
  image: consul:1.17.1

  # Service
  service:
    type: ClusterIP
    port: 8500

  # Persistence
  persistence:
    enabled: true
    storageClass: standard
    accessMode: ReadWriteOnce
    size: 20Gi
    mountPath: /consul/data

  # Resources
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 500m
      memory: 512Mi

  # Raft конфигурация
  raftMultiplier: 1

# Consul Client (DaemonSet)
client:
  enabled: true
  image: consul:1.17.1

  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 250m
      memory: 256Mi

# UI
ui:
  enabled: true
  port: 8500

# Service Mesh (Connect)
connectInject:
  enabled: true
  default: false
  transparentProxy:
    enabled: false

# Ingress through Traefik
ingress:
  enabled: true
  className: traefik
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: web,websecure
  hosts:
    - host: consul.local
      paths:
        - path: /
          pathType: Prefix
  tls:
    enabled: true
    secretName: consul-tls

# Security
security:
  acls:
    enabled: false
    # defaultPolicy: deny
    # downPolicy: extend-cache
  tls:
    enabled: false

# Gossip Encryption
gossipEncryption:
  enabled: false
  # secretName: consul-gossip-encryption

agentConfig:
  datacenter: dc1
  domain: consul
  disableHostNodeId: false
  enableCentralizedConfig: true

# Metrics
metrics:
  enabled: true
  prometheusRetentionTime: 15m

# Consul DNS
dns:
  enabled: true
  port: 8600
