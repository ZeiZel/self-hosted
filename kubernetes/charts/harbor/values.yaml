namespace: infrastructure

create:
  namespace: true

# Harbor configuration using official chart values
harbor:
  # External PostgreSQL (use existing postgres chart)
  externalDatabase:
    postgresql:
      host: "postgres-0.postgres-headless.db.svc.cluster.local"
      port: "5432"
      database: "registry"
      username: "harbor"
      password: "" # Set in secrets

  # External Redis (use existing valkey)
  externalRedis:
    host: "valkey-headless.db.svc.cluster.local"
    port: "6379"
    password: "" # Set in secrets

  # Harbor core settings
  expose:
    type: ingress
    ingress:
      className: traefik
      hosts:
        core: harbor.localhost
        notary: notary.harbor.localhost
      tls:
        enabled: true
        secretName: harbor-tls

  # Harbor components
  persistence:
    enabled: true
    persistentVolumeClaim:
      registry:
        storageClass: standard
        size: 50Gi
      chartmuseum:
        storageClass: standard
        size: 10Gi
      jobservice:
        storageClass: standard
        size: 1Gi
      redis:
        storageClass: standard
        size: 1Gi

  # Harbor configuration
  harborAdminPassword: "" # Set in secrets
  secretKey: "" # Set in secrets

  # Integration with Authentik
  oidc:
    enabled: false
    name: "authentik"
    endpoint: "https://authentik.localhost/application/o/harbor/"
    verifyCert: true

# Override official chart values
harborChartValues:
  expose:
    type: ingress
    ingress:
      className: traefik
      hosts:
        core: harbor.localhost
      tls:
        enabled: true





