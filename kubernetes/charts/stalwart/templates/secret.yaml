apiVersion: v1
kind: Secret
metadata:
  name: stalwart-secrets
  namespace: {{ .Values.namespace }}
type: Opaque
stringData:
  # Domain configuration
  STALWART_HOSTNAME: {{ .Values.stalwart.config.domain }}

  # LDAP для Authentik
  LDAP_HOST: {{ .Values.ldap.host }}
  LDAP_PORT: "{{ .Values.ldap.port }}"
  LDAP_BIND_DN: {{ .Values.ldap.bindDN }}
  LDAP_BIND_PASSWORD: {{ .Values.ldap.bindPassword }}
  LDAP_BASE_DN: {{ .Values.ldap.baseDN }}
  LDAP_AUTH_METHOD: {{ .Values.ldap.authMethod }}

  {{- if .Values.postgresql.enabled }}
  # PostgreSQL
  DATABASE_URL: "postgresql://{{ .Values.postgresql.username }}:{{ .Values.postgresql.password }}@{{ .Values.postgresql.host }}:{{ .Values.postgresql.port }}/{{ .Values.postgresql.database }}"
  {{- end }}

  {{- if .Values.redis.enabled }}
  # Redis
  REDIS_URL: "redis://{{ if .Values.redis.password }}:{{ .Values.redis.password }}@{{ end }}{{ .Values.redis.host }}:{{ .Values.redis.port }}/0"
  {{- end }}
