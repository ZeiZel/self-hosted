---
- name: Create Pangolin client directory
  file:
    path: "{{ pangolin_install_dir }}"
    state: directory
    mode: '0755'

- name: Create config directory
  file:
    path: "{{ pangolin_install_dir }}/config"
    state: directory
    mode: '0755'

- name: Deploy client docker-compose.yml
  template:
    src: docker-compose.yml.j2
    dest: "{{ pangolin_install_dir }}/docker-compose.yml"
    mode: '0644'

- name: Start Pangolin client (Newt)
  community.docker.docker_compose_v2:
    project_src: "{{ pangolin_install_dir }}"
    state: present

- name: Wait for Newt to connect
  pause:
    seconds: 10

- name: Display connection info
  debug:
    msg: |
      Pangolin client started!
      Check connection: docker logs gerbil
      WireGuard status: docker exec gerbil wg show
