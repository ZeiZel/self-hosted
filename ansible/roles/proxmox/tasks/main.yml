---
# Main entry point for proxmox role
# This role handles Proxmox setup, Terraform provisioning, and post-provision checks
#
# Tags:
#   - proxmox: Run all proxmox tasks
#   - proxmox-setup: Setup and verify Proxmox host (API, templates, storage)
#   - terraform: Provision VMs with Terraform
#   - post-provision: Post-provisioning checks and verification

- name: Display Proxmox role information
  debug:
    msg: |
      Proxmox Role Starting...
      Available operations (use tags to select):
        - proxmox-setup: Verify Proxmox host configuration
        - terraform: Provision VMs with Terraform
        - post-provision: Post-provisioning verification
  tags:
    - always

# =============================================================================
# PROXMOX SETUP - Verify and configure Proxmox host
# =============================================================================
- name: Include Proxmox setup tasks
  include_tasks: setup/main.yml
  tags:
    - proxmox
    - proxmox-setup

# =============================================================================
# TERRAFORM - Provision VMs
# =============================================================================
- name: Include Terraform provisioning tasks
  include_tasks: terraform/main.yml
  tags:
    - proxmox
    - terraform

# =============================================================================
# POST-PROVISION - Verify provisioned VMs
# =============================================================================
- name: Include post-provision tasks
  include_tasks: post_provision/main.yml
  tags:
    - proxmox
    - post-provision
