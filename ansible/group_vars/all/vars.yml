---
# deployed apps
infrastructure:
  base:
    - namespace
    - traefik
    - vault
    - consul
  apps:
    - stoat
    - swalwart
    - youtrack
    - hub
    - teamcity
    - authentik
    - vaultwarden

docker_edition: 'ce'

firewall:
  allowed_tcp_ports:
    - "{{ ssh.port }}"    # SSH (custom port)
    - 80      # HTTP
    - 443     # HTTPS
  allowed_udp_ports:
    - 51820   # WireGuard
    - 21820   # WireGuard alt

sysctl_config:
  net.ipv4.ip_forward: 1
  net.ipv4.conf.all.src_valid_mark: 1
  net.ipv6.conf.all.forwarding: 1

# Pangolin settings
pangolin_version: "1.15.0"
gerbil_version: "1.3.0"
traefik_version: "v3.4.0"
pangolin_install_dir: "/opt/pangolin"
wireguard_network: "10.99.0.0/24"
wireguard_server_ip: "10.99.0.1"
wireguard_port: 51820

# Proxmox configuration
proxmox:
  api_host: "{{ proxmox_api_host | default('192.168.100.2') }}"
  api_port: 8006
  node_name: "{{ proxmox_node_name | default('local-server') }}"
  storage_pool: "local"
  network_bridge: "vmbr0"
  template_name: "ubuntu-cloud-init"  # Ubuntu 25.10 or Debian 13 template
  network:
    gateway: "192.168.100.1"
    netmask: "255.255.255.0"
    dns: "8.8.8.8,8.8.4.4"

# Terraform configuration
terraform:
  version: "1.7.0"
  working_dir: "{{ playbook_dir }}/terraform/proxmox"
  state_file: "terraform.tfstate"

# VM specifications
vm_master:
  count: 1
  name_prefix: "k8s-master"
  cpu_cores: 8
  memory_mb: 8192
  disk_size_gb: 200
  ip_start: "192.168.100.10"

vm_worker_db:
  count: 1
  name: "k8s-worker-db"
  cpu_cores: 3
  memory_mb: 10240
  disk_size_gb: 400
  ip: "192.168.100.11"
  node_labels:
    - "node-role.kubernetes.io/worker-db="
    - "workload=database"

vm_worker_services:
  count: 1
  name: "k8s-worker-services"
  cpu_cores: 3
  memory_mb: 8192
  disk_size_gb: 200
  ip: "192.168.100.12"
  node_labels:
    - "node-role.kubernetes.io/worker-services="
    - "workload=critical-services"

vm_worker_apps:
  count: 1
  name: "k8s-worker-apps"
  cpu_cores: 2
  memory_mb: 6144
  disk_size_gb: 200
  ip: "192.168.100.13"
  node_labels:
    - "node-role.kubernetes.io/worker-apps="
    - "workload=applications"
