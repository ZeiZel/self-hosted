---
- name: Host
  hosts: local
  become: true
  gather_facts: true
  roles:
    - role: setup_host

- name: Master
  hosts: master
  gather_facts: true
  roles:
    - role: setup_server
    - role: docker
    - role: security
    - role: kubespray
      tags: master
      type: node
    - role: apps
      tags: master
    - role: pangolin
      tags: node

- name: Worker
  hosts: workers
  gather_facts: true
  roles:
    - role: setup_server
    - role: docker
    - role: security
    - role: kubespray
      tags: worker
      type: node
    - role: apps
      tags: worker
    - role: pangolin
      tags: node

- name: Gateway
  hosts: gateway
  gather_facts: true
  roles:
    - role: setup_server
    - role: docker
    - role: security
    - role: kubespray
      tags: worker
      type: gateway
    - role: apps
      tags: gateway
    - role: pangolin
      tags: gateway
