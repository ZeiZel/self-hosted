---
sidebar_position: 10
---

# Ресурсы и требования

В этом разделе описаны требования к ресурсам для развёртки всей инфраструктуры.

## Требования к VPS

VPS сервер используется для размещения Pangolin сервера, который обеспечивает VPN туннель и reverse proxy для доступа к сервисам.

### Минимальные требования

- **CPU:** 2 ядра
- **RAM:** 2 GB
- **Диск:** 20 GB SSD
- **ОС:** Ubuntu 20.04/22.04 или Debian 11/12
- **Сеть:** Статический IP адрес, минимум 100 Mbps
- **Открытые порты:**
  - 22 (SSH)
  - 80 (HTTP) - для Let's Encrypt
  - 443 (HTTPS)
  - 51820/UDP (WireGuard)

### Рекомендуемые требования

- **CPU:** 4 ядра
- **RAM:** 4 GB
- **Диск:** 40 GB SSD
- **Сеть:** Статический IP, 1 Gbps

### Дополнительные требования

- **Домен:** Рекомендуется иметь домен для работы с Let's Encrypt
- **DNS:** Возможность настройки DNS записей (A, MX, TXT)

## Требования к локальному серверу (Kubernetes)

Локальный сервер используется для размещения Kubernetes кластера со всеми сервисами.

### Минимальные требования для Master node

- **CPU:** 2 ядра
- **RAM:** 2 GB
- **Диск:** 20 GB SSD
- **ОС:** Ubuntu 20.04/22.04 или аналогичная
- **Сеть:** Стабильное подключение к интернету

### Минимальные требования для Worker node

- **CPU:** 4 ядра
- **RAM:** 4 GB
- **Диск:** 50 GB SSD
- **ОС:** Ubuntu 20.04/22.04 или аналогичная
- **Сеть:** Стабильное подключение к интернету

### Рекомендуемые требования для Master node

- **CPU:** 4 ядра
- **RAM:** 4 GB
- **Диск:** 50 GB SSD
- **HA:** 3 master узла для высокой доступности

### Рекомендуемые требования для Worker node

- **CPU:** 8 ядер
- **RAM:** 16 GB
- **Диск:** 100 GB SSD
- **Количество:** Минимум 3 worker узла

### Требования к хранилищу

- **Storage Class:** Рекомендуется использовать SSD storage
- **Минимальный объём:** 200 GB для всех persistent volumes
- **Рекомендуемый объём:** 500 GB+

### Сетевые требования

- **Локальная сеть:** Все узлы должны быть в одной сети
- **Bandwidth:** Минимум 1 Gbps между узлами
- **Latency:** Низкая задержка между узлами (< 1ms)

## Требования к локальной машине (управление)

Локальная машина используется для управления всей инфраструктурой через Ansible, Terraform, kubectl и другие инструменты.

### Операционная система

- **macOS:** 10.15+ (рекомендуется)
- **Linux:** Ubuntu 20.04+ или аналогичный дистрибутив
- **Windows:** Windows 10/11 с WSL2 (Ubuntu)

### Установленные инструменты

Все инструменты должны быть установлены (см. [Подготовка локального устройства](./preparation.md)):

- **Ansible:** 2.9+
- **Terraform:** 1.0+
- **kubectl:** 1.28+
- **Helm:** 3.8+
- **Helmfile:** 0.155+
- **Docker:** 20.10+ (опционально, для локальной разработки)
- **GPG:** 2.2+
- **SOPS:** 3.7+

### Требования к сети

- **SSH доступ:** Доступ к VPS и Kubernetes узлам
- **Интернет:** Для загрузки образов и пакетов
- **Bandwidth:** Минимум 10 Mbps для комфортной работы

### Системные требования

- **RAM:** 8 GB (рекомендуется)
- **Диск:** 20 GB свободного места
- **CPU:** 2+ ядра

## Детальные требования по ресурсам сервисов

### Базы данных

#### PostgreSQL

- **CPU:** 1-2 ядра
- **RAM:** 1-2 GB
- **Диск:** 20-50 GB (зависит от объёма данных)
- **Replicas:** 3 (для HA)

#### MongoDB

- **CPU:** 1-2 ядра
- **RAM:** 2-4 GB
- **Диск:** 20-50 GB
- **Replica Set:** 3 узла

#### ValKey

- **CPU:** 0.5-1 ядро
- **RAM:** 512 MB - 1 GB
- **Диск:** 5-10 GB
- **Architecture:** Replication (1 master + 2 replicas)

#### MinIO

- **CPU:** 1-2 ядра
- **RAM:** 1-2 GB
- **Диск:** 50-500 GB (зависит от объёма хранилища)

### Инфраструктурные сервисы

#### Traefik

- **CPU:** 0.5-1 ядро
- **RAM:** 256-512 MB
- **Replicas:** 2-3 (для HA)

#### Consul

- **CPU:** 0.5-1 ядро
- **RAM:** 512 MB - 1 GB
- **Replicas:** 3-5 (для HA)

#### Vault

- **CPU:** 1-2 ядра
- **RAM:** 512 MB - 1 GB
- **Диск:** 10-20 GB
- **Replicas:** 3 (для HA)

#### Prometheus

- **CPU:** 1-2 ядра
- **RAM:** 2-4 GB
- **Диск:** 50-200 GB (зависит от retention)

#### Grafana

- **CPU:** 0.5-1 ядро
- **RAM:** 512 MB - 1 GB
- **Диск:** 5-10 GB

#### Loki

- **CPU:** 1-2 ядра
- **RAM:** 2-4 GB
- **Диск:** 50-200 GB (зависит от retention)

### Приложения

#### GitLab

- **CPU:** 4-8 ядер
- **RAM:** 8-16 GB
- **Диск:** 50-200 GB

#### TeamCity

- **CPU:** 2-4 ядра (server) + 2-4 ядра на агента
- **RAM:** 2-4 GB (server) + 2-4 GB на агента
- **Диск:** 20-50 GB (server) + 10-20 GB на агента

#### YouTrack

- **CPU:** 2-4 ядра
- **RAM:** 2-4 GB
- **Диск:** 20-50 GB

#### Vaultwarden

- **CPU:** 0.5-1 ядро
- **RAM:** 512 MB - 1 GB
- **Диск:** 10-50 GB (зависит от количества пользователей)

#### Notesnook

- **CPU:** 1-2 ядра (server + identity + SSE)
- **RAM:** 2-4 GB
- **Диск:** 10-50 GB

#### Authentik

- **CPU:** 1-2 ядра
- **RAM:** 1-2 GB
- **Диск:** 10-20 GB

## Суммарные требования

### Минимальная конфигурация (для тестирования)

**VPS:**
- 2 CPU, 2 GB RAM, 20 GB диск

**Kubernetes (1 master + 1 worker):**
- Master: 2 CPU, 2 GB RAM, 20 GB диск
- Worker: 4 CPU, 4 GB RAM, 50 GB диск
- **Итого:** 6 CPU, 6 GB RAM, 70 GB диск

**Рекомендация:** Подходит только для тестирования, не для production.

### Рекомендуемая конфигурация (для production)

**VPS:**
- 4 CPU, 4 GB RAM, 40 GB диск

**Kubernetes (3 masters + 3 workers):**
- Masters: 3 × (4 CPU, 4 GB RAM, 50 GB диск) = 12 CPU, 12 GB RAM, 150 GB диск
- Workers: 3 × (8 CPU, 16 GB RAM, 100 GB диск) = 24 CPU, 48 GB RAM, 300 GB диск
- **Итого:** 36 CPU, 60 GB RAM, 450 GB диск

**Рекомендация:** Оптимальная конфигурация для полнофункциональной production системы.

### Масштабирование

Для больших нагрузок можно:
- Добавить дополнительные worker узлы
- Увеличить ресурсы существующих узлов
- Использовать горизонтальное масштабирование подов
- Настроить автоскейлинг

## Оценка стоимости

### VPS (примерно)

- Минимальная: $10-20/месяц
- Рекомендуемая: $20-40/месяц

### Локальный сервер (примерно)

- Минимальная конфигурация: $500-1000 (одноразово)
- Рекомендуемая конфигурация: $2000-5000 (одноразово)

Или можно использовать облачные сервисы (AWS, GCP, Azure) с аналогичными требованиями.

## Оптимизация ресурсов

### Рекомендации по оптимизации

1. **Используйте SSD** для всех дисков
2. **Настройте ресурсы подов** в values.yaml согласно реальным потребностям
3. **Включите горизонтальное масштабирование** для приложений
4. **Используйте resource quotas** для ограничения использования ресурсов
5. **Настройте node affinity** для оптимального размещения подов
6. **Регулярно очищайте** неиспользуемые образы и данные

### Мониторинг использования ресурсов

Регулярно проверяйте использование ресурсов:

```bash
kubectl top nodes
kubectl top pods --all-namespaces
```

Используйте Grafana для визуализации использования ресурсов и планирования масштабирования.

## Следующие шаги

После оценки требований:

1. Подготовьте необходимое оборудование
2. Настройте сеть
3. Начните с [Подготовки локального устройства](./preparation.md)





